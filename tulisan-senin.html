<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Kenapa Senin Seru? - Tulisan Jati</title>
    <link href="https://fonts.googleapis.com/css2?family=Manrope:wght@300;400;500;700;800&display=swap" rel="stylesheet">
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            theme: {
                extend: {
                    fontFamily: { sans: ['Manrope', 'sans-serif'] },
                    colors: {
                        'pop-bg': '#FFFDF5',
                        'pop-dark': '#1C1917',
                        'pop-purple': '#E0CCFF',
                    },
                    borderRadius: { '4xl': '2.5rem' }
                }
            }
        }
    </script>
    <style>
        body { background-color: #FFFDF5; color: #1C1917; }
        /* Styling untuk konten artikel biar enak dibaca */
        .prose p { margin-bottom: 1.5rem; line-height: 1.8; }
        .prose h3 { font-weight: 800; font-size: 1.25rem; margin-top: 2rem; margin-bottom: 1rem; }
        .prose ul { list-style-type: disc; padding-left: 1.5rem; margin-bottom: 1.5rem; }
    </style>
</head>
<body class="antialiased">

    <!-- NAV -->
    <nav class="fixed top-0 w-full z-50 px-4 py-6">
        <div class="max-w-5xl mx-auto bg-white/70 backdrop-blur-lg border border-white/40 rounded-full px-6 py-3 flex justify-between items-center shadow-sm">
            <a href="tulisan.html" class="font-bold text-sm flex items-center gap-2 hover:opacity-70 transition text-gray-500">
                ‚Üê Kembali ke Daftar
            </a>
            <div class="font-extrabold text-lg tracking-tight">halo.user</div>
            <div class="w-20"></div> <!-- Spacer biar logo tengah -->
        </div>
    </nav>

    <main class="pt-32 pb-20 px-6 max-w-2xl mx-auto">
        
        <!-- HEADER ARTIKEL -->
        <div class="mb-10 text-center">
            <span class="bg-pop-purple/50 text-purple-900 px-3 py-1 rounded-full text-xs font-bold uppercase tracking-wide">Life Hacks</span>
            <h1 class="text-3xl md:text-5xl font-extrabold mt-4 mb-4 leading-tight">Kenapa Senin itu Sebenarnya Seru</h1>
            <p class="text-gray-500 text-sm font-mono">Ditulis pada 01 Des 2024 ‚Ä¢ 3 Menit Baca</p>
        </div>

        <!-- ISI KONTEN (Gunakan class 'prose') -->
        <article class="prose text-gray-700 text-lg">
            <p>
                Oke, dengar dulu. Aku tahu "I Hate Monday" itu slogan sejuta umat. Rasanya liburan akhir pekan lewat begitu saja secepat kilat, dan tiba-tiba alarm berbunyi di Senin pagi. Tapi coba ubah perspektifnya sedikit.
            </p>
            <p>
                Senin itu kayak tombol <strong>reset</strong>. Apapun kesalahan, kemalasan, atau kekacauan minggu lalu, sudah lewat. Minggu ini? Kertas kosong baru. Kamu punya kesempatan untuk memulai lagi dari nol.
            </p>

            <h3>Rahasia Biar Nggak Benci Senin</h3>
            <p>Aku punya beberapa trik yang selalu aku pakai supaya Senin nggak terasa berat:</p>
            <ul>
                <li><strong>Jangan kerja berat di pagi hari:</strong> Gunakan 1-2 jam pertama untuk transisi pelan-pelan. Cek email santai, rapikan meja.</li>
                <li><strong>Beli kopi yang enak:</strong> Anggap ini reward karena kamu sudah bangun pagi.</li>
                <li><strong>Pakai baju favorit:</strong> Kalau kamu merasa keren, mood kamu otomatis naik.</li>
            </ul>

            <p>
                Jadi, minggu depan, coba jangan langsung mengeluh saat bangun tidur. Tarik napas, minum air putih, dan hadapi hari dengan mindset "Hari ini aku akan membereskan semuanya."
            </p>
        </article>

        <!-- Divider -->
        <div class="h-px bg-gray-200 w-full my-12"></div>

        <!-- KOLOM KOMENTAR SPESIFIK -->
        <div class="bg-white p-6 md:p-8 rounded-4xl border border-gray-100 shadow-sm">
            <h3 class="font-bold text-xl mb-6">Diskusi Tulisan Ini üí¨</h3>
            
            <!-- Form -->
            <form id="commentForm" class="mb-8">
                <div class="flex gap-2 mb-3">
                    <input type="text" id="nameInput" placeholder="Namamu" class="bg-gray-50 border border-gray-200 rounded-xl px-4 py-2 text-sm font-bold focus:outline-none w-1/3" required>
                    <input type="text" id="msgInput" placeholder="Tulis komentar..." class="bg-gray-50 border border-gray-200 rounded-xl px-4 py-2 text-sm w-full focus:outline-none" required>
                </div>
                <button type="submit" id="submitBtn" class="bg-pop-dark text-white text-sm font-bold px-6 py-2 rounded-xl hover:bg-gray-800 transition">Kirim</button>
            </form>

            <!-- List Komentar -->
            <div id="commentsList" class="space-y-4">
                <p class="text-gray-400 text-sm text-center italic" id="emptyState">Belum ada komentar.</p>
            </div>
        </div>

    </main>

    <!-- FOOTER -->
    <footer class="text-center py-10 text-gray-400 text-sm">
        &copy; 2024 My Personal Space.
    </footer>

    <!-- SCRIPT FIREBASE KHUSUS ARTIKEL INI -->
    <script type="module">
        import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-app.js";
        import { getFirestore, collection, addDoc, query, onSnapshot, serverTimestamp } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-firestore.js";
        import { getAuth, signInAnonymously, signInWithCustomToken } from "https://www.gstatic.com/firebasejs/11.6.1/firebase-auth.js";

        // --- ID UNIK UNTUK ARTIKEL INI ---
        const POST_ID = "kenapa-senin-seru"; 

        // Config Firebase
        let firebaseConfig;
        if (typeof __firebase_config !== 'undefined') {
            firebaseConfig = JSON.parse(__firebase_config);
        } else {
            // Isi config manual jika hosting sendiri
            firebaseConfig = { apiKey: "API_KEY", projectId: "PROJECT_ID", appId: "APP_ID" }; 
        }

        const app = initializeApp(firebaseConfig);
        const db = getFirestore(app);
        const auth = getAuth(app);
        const appId = typeof __app_id !== 'undefined' ? __app_id : 'my-personal-space';

        // Auth
        async function initAuth() {
            try {
                if (typeof __initial_auth_token !== 'undefined' && __initial_auth_token) {
                    await signInWithCustomToken(auth, __initial_auth_token);
                } else {
                    await signInAnonymously(auth);
                }
                loadComments();
            } catch (error) { console.error("Auth Error", error); }
        }
        initAuth();

        const list = document.getElementById('commentsList');
        const emptyState = document.getElementById('emptyState');

        // Load Komentar (Logic Diubah: Filter & Sort di JS untuk menghindari Error Index)
        function loadComments() {
            // Ambil SEMUA komentar dari collection ini tanpa filter database
            const q = query(
                collection(db, 'artifacts', appId, 'public', 'data', 'post_comments')
            );

            onSnapshot(q, (snapshot) => {
                list.innerHTML = '';
                
                let allComments = [];
                snapshot.forEach((doc) => {
                    allComments.push(doc.data());
                });

                // 1. FILTER: Hanya ambil yang postId-nya sama dengan artikel ini
                const myComments = allComments.filter(comment => comment.postId === POST_ID);

                // 2. SORT: Urutkan dari yang terbaru (Timestamp Descending)
                myComments.sort((a, b) => {
                    const timeA = a.createdAt ? a.createdAt.seconds : 0;
                    const timeB = b.createdAt ? b.createdAt.seconds : 0;
                    return timeB - timeA; // Descending
                });

                if (myComments.length === 0) {
                    list.appendChild(emptyState);
                    emptyState.style.display = 'block';
                } else {
                    emptyState.style.display = 'none';
                    
                    myComments.forEach((data) => {
                        const item = document.createElement('div');
                        item.className = "flex gap-3 text-sm animate-fade-in";
                        item.innerHTML = `
                            <div class="w-8 h-8 rounded-full bg-pop-purple flex-shrink-0 flex items-center justify-center font-bold text-xs text-purple-900">${data.name.charAt(0).toUpperCase()}</div>
                            <div>
                                <div class="flex items-baseline gap-2">
                                    <span class="font-bold text-gray-900">${escapeHtml(data.name)}</span>
                                    <span class="text-xs text-gray-400">${data.createdAt ? new Date(data.createdAt.seconds * 1000).toLocaleDateString() : 'Baru saja'}</span>
                                </div>
                                <p class="text-gray-600 mt-0.5 leading-relaxed">${escapeHtml(data.message)}</p>
                            </div>
                        `;
                        list.appendChild(item);
                    });
                }
            });
        }

        // Kirim Komentar
        document.getElementById('commentForm').addEventListener('submit', async (e) => {
            e.preventDefault();
            const name = document.getElementById('nameInput').value;
            const message = document.getElementById('msgInput').value;
            const btn = document.getElementById('submitBtn');

            if(!name || !message) return;
            btn.innerText = "...";
            btn.disabled = true;

            try {
                await addDoc(collection(db, 'artifacts', appId, 'public', 'data', 'post_comments'), {
                    postId: POST_ID, // Simpan ID artikelnya
                    name: name,
                    message: message,
                    createdAt: serverTimestamp()
                });
                document.getElementById('commentForm').reset();
                btn.innerText = "Kirim";
                btn.disabled = false;
            } catch (err) {
                alert("Gagal kirim: " + err.message);
                btn.innerText = "Kirim";
                btn.disabled = false;
            }
        });

        function escapeHtml(text) {
            return text ? text.replace(/&/g, "&amp;").replace(/</g, "&lt;").replace(/>/g, "&gt;") : "";
        }
    </script>
</body>
</html>